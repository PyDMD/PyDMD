<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SpDMD &mdash; PyDMD 0.4 documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contact" href="contact.html" />
    <link rel="prev" title="pydmd.optdmd.OptDMD.snapshots" href="_summaries/pydmd.optdmd.OptDMD.snapshots.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PyDMD
          </a>
              <div class="version">
                0.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="code.html">Code Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dmdbase.html">DMDBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="dmd.html">DMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="mrdmd.html">MrDMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="fbdmd.html">FbDMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdmd.html">CDMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="hankeldmd.html">HankelDMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="hodmd.html">HODMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="dmdc.html">DMDc</a></li>
<li class="toctree-l2"><a class="reference internal" href="optdmd.html">OptDMD</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SpDMD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyDMD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="code.html">Code Documentation</a> &raquo;</li>
      <li>SpDMD</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/spdmd.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-pydmd.spdmd">
<span id="spdmd"></span><h1>SpDMD<a class="headerlink" href="#module-pydmd.spdmd" title="Permalink to this headline">¶</a></h1>
<p>Derived module from dmdbase.py for sparsity-promoting DMD.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.atilde</span></code></p></td>
<td><p>Get the reduced Koopman operator A, called A tilde.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.dmd_timesteps</span></code></p></td>
<td><p>Get the timesteps of the reconstructed states.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.dynamics</span></code></p></td>
<td><p>Get the time evolution of each mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.eigs</span></code></p></td>
<td><p>Get the eigenvalues of A tilde.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.fit</span></code></p></td>
<td><p>Compute the Dynamic Modes Decomposition of the input data.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.modes</span></code></p></td>
<td><p>Get the matrix containing the DMD modes, stored by column.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.original_timesteps</span></code></p></td>
<td><p>Get the timesteps of the original snapshot.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.plot_eigs</span></code></p></td>
<td><p>Plot the eigenvalues.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.plot_modes_2D</span></code></p></td>
<td><p>Plot the DMD Modes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.plot_snapshots_2D</span></code></p></td>
<td><p>Plot the snapshots.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.reconstructed_data</span></code></p></td>
<td><p>Get the reconstructed data.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpDMD.snapshots</span></code></p></td>
<td><p>Get the original input data.</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt>
<em class="property">class </em><code class="sig-name descname">SpDMD</code><span class="sig-paren">(</span><em class="sig-param">svd_rank=0</em>, <em class="sig-param">tlsq_rank=0</em>, <em class="sig-param">opt=False</em>, <em class="sig-param">rescale_mode=None</em>, <em class="sig-param">forward_backward=False</em>, <em class="sig-param">sorted_eigs=False</em>, <em class="sig-param">abs_tolerance=1e-06</em>, <em class="sig-param">rel_tolerance=0.0001</em>, <em class="sig-param">max_iterations=10000</em>, <em class="sig-param">rho=1</em>, <em class="sig-param">gamma=10</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">enforce_zero=True</em>, <em class="sig-param">release_memory=True</em>, <em class="sig-param">zero_absolute_tolerance=1e-12</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydmd.dmd.DMD</span></code></p>
<p>Sparsity-Promoting Dynamic Mode Decomposition. Promotes solutions having an
high number of amplitudes set to zero (i.e. <em>sparse solutions</em>).
Reference: 10.1063/1.4863670</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svd_rank</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – the rank for the truncation; If 0, the method computes the
optimal rank and uses it for truncation; if positive interger, the
method uses the argument for the truncation; if float between 0 and 1,
the rank is the number of the biggest singular values that are needed
to reach the ‘energy’ specified by <cite>svd_rank</cite>; if -1, the method does
not compute truncation.</p></li>
<li><p><strong>tlsq_rank</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – rank truncation computing Total Least Square. Default
is 0, that means TLSQ is not applied.</p></li>
<li><p><strong>opt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – argument to control the computation of DMD modes amplitudes. See
<code class="xref py py-class docutils literal notranslate"><span class="pre">DMDBase</span></code>. Default is False.</p></li>
<li><p><strong>rescale_mode</strong> (<em>{'auto'}</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a><em> or </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.21)"><em>numpy.ndarray</em></a>) – Scale Atilde as shown in
10.1016/j.jneumeth.2015.10.010 (section 2.4) before computing its
eigendecomposition. None means no rescaling, ‘auto’ means automatic
rescaling using singular values, otherwise the scaling factors.</p></li>
<li><p><strong>forward_backward</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, the low-rank operator is computed
like in fbDMD (reference: <a class="reference external" href="https://arxiv.org/abs/1507.02264">https://arxiv.org/abs/1507.02264</a>). Default is
False.</p></li>
<li><p><strong>sorted_eigs</strong> (<em>{'real'</em><em>, </em><em>'abs'}</em><em> or </em><em>False</em>) – Sort eigenvalues (and modes/dynamics accordingly) by
magnitude if <cite>sorted_eigs=’abs’</cite>, by real part (and then by imaginary
part to break ties) if <cite>sorted_eigs=’real’</cite>. Default: False.</p></li>
<li><p><strong>abs_tolerance</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Controls the convergence of ADMM. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">_loop_condition()</span></code> for more details.</p></li>
<li><p><strong>rel_tolerance</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Controls the convergence of ADMM. See
<code class="xref py py-func docutils literal notranslate"><span class="pre">_loop_condition()</span></code> for more details.</p></li>
<li><p><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The maximum number of iterations performed by
ADMM, after that the algorithm is stopped.</p></li>
<li><p><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Controls the convergence of ADMM. For a reference on the
optimal value for <cite>rho</cite> see 10.1109/TAC.2014.2354892 or
10.3182/20120914-2-US-4030.00038.</p></li>
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Controls the level of “promotion” assigned to sparse
solution. Increasing <cite>gamma</cite> will result in an higher number of
zero-amplitudes.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If <cite>False</cite>, the information provided by SpDMD (like
the number of iterations performed by ADMM) are not shown.</p></li>
<li><p><strong>enforce_zero</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If <cite>True</cite> the DMD amplitudes which should be set
to zero according to the solution of ADMM are manually set to 0 (since
we solve a sparse linear system to find the optimal vector of DMD
amplitudes very small terms may survive in some cases).</p></li>
<li><p><strong>release_memory</strong> – If <cite>True</cite> the intermediate matrices computed by the
algorithm are deleted after the termination of a call to <code class="xref py py-func docutils literal notranslate"><span class="pre">fit()</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt>
<code class="sig-name descname">_find_zero_amplitudes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._find_zero_amplitudes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Use ADMM to find which amplitudes (i.e. their position in the
DMD amplitudes array) which can be set to zero according to the given
parameters. Note that this method does not compute amplitudes, but
only which amplitudes are to be set to 0. Optimal amplitudes should be
computed separately afterwards
(see <code class="xref py py-func docutils literal notranslate"><span class="pre">_find_sparsity_promoting_amplitudes()</span></code>).
:return np.ndarray: A boolean vector whose <cite>True</cite> items correspond to</p>
<blockquote>
<div><p>amplitudes which should be set to 0.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">_loop_condition</code><span class="sig-paren">(</span><em class="sig-param">alpha</em>, <em class="sig-param">beta</em>, <em class="sig-param">lmbd</em>, <em class="sig-param">old_beta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._loop_condition"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check whether ADMM can stop now, or should perform another iteration.
:param np.ndarray alpha: Current value of <span class="math">\alpha_k</span> (vector</p>
<blockquote>
<div><p>of DMD amplitudes).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>np.ndarray</em>) – Current value of <span class="math">\beta_k</span> (vector of
non-zero amplitudes).</p></li>
<li><p><strong>lmbd</strong> (<em>np.ndarray</em>) – Current value of <span class="math">\lambda_k</span> (vector
of Lagrange multipliers).</p></li>
<li><p><strong>old_beta</strong> (<em>np.ndarray</em>) – Old value of <span class="math">\beta_{k-1}</span> (vector of
non-zero amplitudes).</p></li>
</ul>
</dd>
<dt class="field-even">Return bool</dt>
<dd class="field-even"><p><cite>True</cite> if ADMM can stop now, <cite>False</cite> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">_optimal_amplitudes</code><span class="sig-paren">(</span><em class="sig-param">zero_amplitudes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._optimal_amplitudes"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Find the optimal DMD amplitudes with the constraint that the given
indexes should be set to 0.
:param np.ndarray zero_amplitudes: Boolean vector.
:return np.ndarray: Vector of optimal DMD amplitudes. Amplitudes at</p>
<blockquote>
<div><p>indexes corresponding to <cite>True</cite> indexes in <cite>zero_amplitudes</cite> are set
to 0.</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">_update</code><span class="sig-paren">(</span><em class="sig-param">beta</em>, <em class="sig-param">lmbd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._update"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Operate an entire step of ADMM.
:param np.ndarray beta: Current value of <span class="math">\beta_k</span> (vector of</p>
<blockquote>
<div><p>non-zero amplitudes).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lmbd</strong> (<em>np.ndarray</em>) – Current value of <span class="math">\lambda_k</span> (vector of
Lagrande multipliers).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing the updated values
<span class="math">\alpha_{k+1},\beta_{k+1},\lambda_{k+1}</span> (in this order).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">_update_alpha</code><span class="sig-paren">(</span><em class="sig-param">beta</em>, <em class="sig-param">lmbd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._update_alpha"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Update the vector <span class="math">\alpha_k</span> of DMD amplitudes.
:param np.ndarray beta: Current value of <span class="math">\beta_k</span> (vector of</p>
<blockquote>
<div><p>non-zero amplitudes).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lmbd</strong> (<em>np.ndarray</em>) – Current value of <span class="math">\lambda_k</span> (vector of
Lagrande multipliers).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The updated value <span class="math">\alpha_{k+1}</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">_update_beta</code><span class="sig-paren">(</span><em class="sig-param">alpha</em>, <em class="sig-param">lmbd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._update_beta"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Update the vector <span class="math">\beta</span> of non-zero amplitudes.
:param np.ndarray alpha: Updated value of <span class="math">\alpha_{k+1}</span> (vector</p>
<blockquote>
<div><p>of DMD amplitudes).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lmbd</strong> (<em>np.ndarray</em>) – Current value of <span class="math">\lambda_k</span> (vector
of Lagrange multipliers).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The updated value <span class="math">\beta_{k+1}</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">_update_lagrangian</code><span class="sig-paren">(</span><em class="sig-param">alpha</em>, <em class="sig-param">beta</em>, <em class="sig-param">lmbd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD._update_lagrangian"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Update the vector <span class="math">\lambda</span> of Lagrange multipliers.
:param np.ndarray alpha: Updated value of <span class="math">\alpha_{k+1}</span> (vector</p>
<blockquote>
<div><p>of DMD amplitudes).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> (<em>np.ndarray</em>) – Updated value of <span class="math">\beta_{k+1}</span> (vector of
non-zero amplitudes).</p></li>
<li><p><strong>lmbd</strong> (<em>np.ndarray</em>) – Current value of <span class="math">\lambda_k</span> (vector
of Lagrange multipliers).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The updated value <span class="math">\lambda_{k+1}</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pydmd/spdmd.html#SpDMD.fit"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Compute the Dynamic Modes Decomposition of the input data.
:param X: the input snapshots.
:type X: numpy.ndarray or iterable</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="_summaries/pydmd.optdmd.OptDMD.snapshots.html" class="btn btn-neutral float-left" title="pydmd.optdmd.OptDMD.snapshots" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contact.html" class="btn btn-neutral float-right" title="Contact" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Copyright 2017-2021, PyDMD contributors.
      <span class="lastupdated">Last updated on Oct 08, 2021.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>