

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pydmd.plotter &mdash; PyDMD 2025.4.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />

  
      <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=b5451040"></script>
      <script src="../../_static/doctools.js?v=888ff710"></script>
      <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PyDMD
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../code.html">Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">PyDMD Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LICENSE.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyDMD</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pydmd.plotter</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pydmd.plotter</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for DMD plotting.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">splitext</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.axes_grid1</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Patch</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pydmd</span><span class="w"> </span><span class="kn">import</span> <span class="n">MrDMD</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.bopdmd</span><span class="w"> </span><span class="kn">import</span> <span class="n">BOPDMD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.hankeldmd</span><span class="w"> </span><span class="kn">import</span> <span class="n">HankelDMD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.havok</span><span class="w"> </span><span class="kn">import</span> <span class="n">HAVOK</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">PrePostProcessingDMD</span>

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.max_open_warning&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


<div class="viewcode-block" id="_enforce_ratio"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter._enforce_ratio">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">_enforce_ratio</span><span class="p">(</span><span class="n">goal_ratio</span><span class="p">,</span> <span class="n">supx</span><span class="p">,</span> <span class="n">infx</span><span class="p">,</span> <span class="n">supy</span><span class="p">,</span> <span class="n">infy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the right value of `supx,infx,supy,infy` to obtain the desired</span>
<span class="sd">    ratio in :func:`plot_eigs`. Ratio is defined as</span>
<span class="sd">    ::</span>
<span class="sd">        dx = supx - infx</span>
<span class="sd">        dy = supy - infy</span>
<span class="sd">        max(dx,dy) / min(dx,dy)</span>

<span class="sd">    :param float goal_ratio: the desired ratio.</span>
<span class="sd">    :param float supx: the old value of `supx`, to be adjusted.</span>
<span class="sd">    :param float infx: the old value of `infx`, to be adjusted.</span>
<span class="sd">    :param float supy: the old value of `supy`, to be adjusted.</span>
<span class="sd">    :param float infy: the old value of `infy`, to be adjusted.</span>
<span class="sd">    :return tuple: a tuple which contains the updated values of</span>
<span class="sd">        `supx,infx,supy,infy` in this order.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dx</span> <span class="o">=</span> <span class="n">supx</span> <span class="o">-</span> <span class="n">infx</span>
    <span class="k">if</span> <span class="n">dx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mf">1.0e-16</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">supy</span> <span class="o">-</span> <span class="n">infy</span>
    <span class="k">if</span> <span class="n">dy</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="mf">1.0e-16</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ratio</span> <span class="o">&gt;=</span> <span class="n">goal_ratio</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dx</span> <span class="o">&lt;</span> <span class="n">dy</span><span class="p">:</span>
            <span class="n">goal_size</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">goal_ratio</span>

            <span class="n">supx</span> <span class="o">+=</span> <span class="p">(</span><span class="n">goal_size</span> <span class="o">-</span> <span class="n">dx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">infx</span> <span class="o">-=</span> <span class="p">(</span><span class="n">goal_size</span> <span class="o">-</span> <span class="n">dx</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="n">dx</span><span class="p">:</span>
            <span class="n">goal_size</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">goal_ratio</span>

            <span class="n">supy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">goal_size</span> <span class="o">-</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">infy</span> <span class="o">-=</span> <span class="p">(</span><span class="n">goal_size</span> <span class="o">-</span> <span class="n">dy</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">supx</span><span class="p">,</span> <span class="n">infx</span><span class="p">,</span> <span class="n">supy</span><span class="p">,</span> <span class="n">infy</span><span class="p">)</span></div>


<div class="viewcode-block" id="_plot_limits"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter._plot_limits">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">_plot_limits</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">narrow_view</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">narrow_view</span><span class="p">:</span>
        <span class="n">supx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span>
        <span class="n">infx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="o">.</span><span class="n">real</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.05</span>

        <span class="n">supy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span>
        <span class="n">infy</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.05</span>

        <span class="k">return</span> <span class="n">_enforce_ratio</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">supx</span><span class="p">,</span> <span class="n">infx</span><span class="p">,</span> <span class="n">supy</span><span class="p">,</span> <span class="n">infy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="p">)))</span></div>


<div class="viewcode-block" id="plot_eigs"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter.plot_eigs">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_eigs</span><span class="p">(</span>
    <span class="n">dmd</span><span class="p">,</span>
    <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_unit_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">narrow_view</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">dpi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the eigenvalues.</span>

<span class="sd">    :param dmd: DMD instance.</span>
<span class="sd">    :type dmd: pydmd.DMDBase</span>
<span class="sd">    :param bool show_axes: if True, the axes will be showed in the plot.</span>
<span class="sd">        Default is True.</span>
<span class="sd">    :param bool show_unit_circle: if True, the circle with unitary radius</span>
<span class="sd">        and center in the origin will be showed. Default is True.</span>
<span class="sd">    :param tuple(int,int) figsize: tuple in inches defining the figure</span>
<span class="sd">        size. Default is (8, 8).</span>
<span class="sd">    :param str title: title of the plot.</span>
<span class="sd">    :param narrow_view bool: if True, the plot will show only the smallest</span>
<span class="sd">        rectangular area which contains all the eigenvalues, with a padding</span>
<span class="sd">        of 0.05. Not compatible with `show_axes=True`. Default is False.</span>
<span class="sd">    :param dpi int: If not None, the given value is passed to</span>
<span class="sd">        ``plt.figure``.</span>
<span class="sd">    :param str filename: if specified, the plot is saved at `filename`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">MrDMD</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You should use plot_eigs_mrdmd instead&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The eigenvalues have not been computed.&quot;</span>
            <span class="s2">&quot;You have to call the fit() method.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">dpi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">points</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">narrow_view</span><span class="p">:</span>
        <span class="n">supx</span><span class="p">,</span> <span class="n">infx</span><span class="p">,</span> <span class="n">supy</span><span class="p">,</span> <span class="n">infy</span> <span class="o">=</span> <span class="n">_plot_limits</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">narrow_view</span><span class="p">)</span>

        <span class="c1"># set limits for axis</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">infx</span><span class="p">,</span> <span class="n">supx</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">infy</span><span class="p">,</span> <span class="n">supy</span><span class="p">))</span>

        <span class="c1"># x and y axes</span>
        <span class="k">if</span> <span class="n">show_axes</span><span class="p">:</span>
            <span class="n">endx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">supx</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">endx</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">infx</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span> <span class="k">if</span> <span class="n">endx</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">)),</span>
            <span class="p">)</span>

            <span class="n">endy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">supy</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">infy</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span> <span class="k">if</span> <span class="n">endy</span> <span class="o">==</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="s2">&quot;-&quot;</span><span class="p">)),</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># set limits for axis</span>
        <span class="n">limit</span> <span class="o">=</span> <span class="n">_plot_limits</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">narrow_view</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>

        <span class="c1"># x and y axes</span>
        <span class="k">if</span> <span class="n">show_axes</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Imaginary part&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Real part&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_unit_circle</span><span class="p">:</span>
        <span class="n">unit_circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
            <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="mf">1.0</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
            <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Unit circle&quot;</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">unit_circle</span><span class="p">)</span>

    <span class="c1"># Dashed grid</span>
    <span class="n">gridlines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xgridlines</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ygridlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">gridlines</span><span class="p">:</span>
        <span class="n">line</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="s2">&quot;-.&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># legend</span>
    <span class="k">if</span> <span class="n">show_unit_circle</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
                <span class="p">[</span><span class="n">points</span><span class="p">,</span> <span class="n">unit_circle</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">,</span> <span class="s2">&quot;Unit circle&quot;</span><span class="p">],</span>
                <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="n">points</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_eigs_mrdmd"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter.plot_eigs_mrdmd">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_eigs_mrdmd</span><span class="p">(</span>
    <span class="n">dmd</span><span class="p">,</span>
    <span class="n">show_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_unit_circle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the eigenvalues.</span>

<span class="sd">    :param bool show_axes: if True, the axes will be showed in the plot.</span>
<span class="sd">            Default is True.</span>
<span class="sd">    :param bool show_unit_circle: if True, the circle with unitary radius</span>
<span class="sd">            and center in the origin will be showed. Default is True.</span>
<span class="sd">    :param tuple(int,int) figsize: tuple in inches of the figure.</span>
<span class="sd">    :param str title: title of the plot.</span>
<span class="sd">    :param int level: plot only the eigenvalues of specific level.</span>
<span class="sd">    :param int node: plot only the eigenvalues of specific node.</span>
<span class="sd">    :param str filename: if specified, the plot is saved at `filename`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">MrDMD</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected MrDMD, found </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">dmd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The eigenvalues have not been computed.&quot;</span>
            <span class="s2">&quot;You have to perform the fit method.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">level</span><span class="p">:</span>
        <span class="n">peigs</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">partial_eigs</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">peigs</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">level</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">dmd_tree</span><span class="o">.</span><span class="n">levels</span><span class="p">))]</span>

        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">dmd</span><span class="o">.</span><span class="n">dmd_tree</span><span class="o">.</span><span class="n">levels</span><span class="p">:</span>
            <span class="n">eigs</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">partial_eigs</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eigs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">eigs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">l</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">peigs</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">peigs</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s2">&quot;bo&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eigenvalues&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># set limits for axis</span>
    <span class="n">limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">peigs</span><span class="p">)))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="o">-</span><span class="n">limit</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Imaginary part&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Real part&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_unit_circle</span><span class="p">:</span>
        <span class="n">unit_circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span>
            <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">unit_circle</span><span class="p">)</span>

    <span class="c1"># Dashed grid</span>
    <span class="n">gridlines</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xgridlines</span><span class="p">()</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ygridlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">gridlines</span><span class="p">:</span>
        <span class="n">line</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="s2">&quot;-.&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

    <span class="c1"># x and y axes</span>
    <span class="k">if</span> <span class="n">show_axes</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]),</span> <span class="mf">0.0</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="o">-</span><span class="n">limit</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="c1"># legend</span>
    <span class="k">if</span> <span class="n">level</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Eigenvalues - level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Eigenvalues - level </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">))]</span>

    <span class="k">if</span> <span class="n">show_unit_circle</span><span class="p">:</span>
        <span class="n">points</span> <span class="o">+=</span> <span class="p">[</span><span class="n">unit_circle</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;Unit circle&quot;</span><span class="p">]</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_modes_2D"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter.plot_modes_2D">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_modes_2D</span><span class="p">(</span>
    <span class="n">dmd</span><span class="p">,</span>
    <span class="n">snapshots_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">index_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the DMD Modes.</span>

<span class="sd">    :param dmd: DMD instance.</span>
<span class="sd">    :type dmd: pydmd.DMDBase</span>
<span class="sd">    :param snapshots_shape: Shape of the snapshots.</span>
<span class="sd">    :type tuple: A tuple of ints containing the shape of a single snapshot.</span>
<span class="sd">    :param index_mode: the index of the modes to plot. By default, all</span>
<span class="sd">        the modes are plotted.</span>
<span class="sd">    :type index_mode: int or sequence(int)</span>
<span class="sd">    :param str filename: if specified, the plot is saved at `filename`.</span>
<span class="sd">    :param numpy.ndarray x: domain abscissa.</span>
<span class="sd">    :param numpy.ndarray y: domain ordinate</span>
<span class="sd">    :param order: read the elements of snapshots using this index order,</span>
<span class="sd">        and place the elements into the reshaped array using this index</span>
<span class="sd">        order.  It has to be the same used to store the snapshot. &#39;C&#39; means</span>
<span class="sd">        to read/ write the elements using C-like index order, with the last</span>
<span class="sd">        axis index changing fastest, back to the first axis index changing</span>
<span class="sd">        slowest.  &#39;F&#39; means to read / write the elements using Fortran-like</span>
<span class="sd">        index order, with the first index changing fastest, and the last</span>
<span class="sd">        index changing slowest.  Note that the &#39;C&#39; and &#39;F&#39; options take no</span>
<span class="sd">        account of the memory layout of the underlying array, and only</span>
<span class="sd">        refer to the order of indexing.  &#39;A&#39; means to read / write the</span>
<span class="sd">        elements in Fortran-like index order if a is Fortran contiguous in</span>
<span class="sd">        memory, C-like order otherwise.</span>
<span class="sd">    :type order: {&#39;C&#39;, &#39;F&#39;, &#39;A&#39;}, default &#39;C&#39;.</span>
<span class="sd">    :param tuple(int,int) figsize: tuple in inches defining the figure</span>
<span class="sd">        size. Default is (8, 8).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dmd</span><span class="o">.</span><span class="n">modes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The modes have not been computed.&quot;</span>
            <span class="s2">&quot;You have to perform the fit method.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">snapshots_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">snapshots_shape</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">snapshots_shape</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">snapshots_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;No information about the original shape of the snapshots.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dimension of the input snapshots is not 2D.&quot;</span><span class="p">)</span>

    <span class="c1"># If domain dimensions have not been passed as argument,</span>
    <span class="c1"># use the snapshots dimensions</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">xgrid</span><span class="p">,</span> <span class="n">ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">index_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">index_mode</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index_mode</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">index_mode</span> <span class="o">=</span> <span class="p">[</span><span class="n">index_mode</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">index_mode</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DMD Mode </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">real_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">imag_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">mode</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">modes</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

        <span class="n">real</span> <span class="o">=</span> <span class="n">real_ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span>
            <span class="n">xgrid</span><span class="p">,</span>
            <span class="n">ygrid</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;jet&quot;</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="n">imag</span> <span class="o">=</span> <span class="n">imag_ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span>
            <span class="n">xgrid</span><span class="p">,</span>
            <span class="n">ygrid</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">imag</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">imag</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">real</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">real_ax</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">imag</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">imag_ax</span><span class="p">)</span>

        <span class="n">real_ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
        <span class="n">imag_ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>

        <span class="n">real_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Real&quot;</span><span class="p">)</span>
        <span class="n">imag_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Imag&quot;</span><span class="p">)</span>

        <span class="c1"># padding between elements</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">idx</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_snapshots_2D"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter.plot_snapshots_2D">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_snapshots_2D</span><span class="p">(</span>
    <span class="n">dmd</span><span class="p">,</span>
    <span class="n">snapshots_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">index_snap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the snapshots.</span>

<span class="sd">    :param dmd: DMD instance.</span>
<span class="sd">    :type dmd: pydmd.DMDBase</span>
<span class="sd">    :param snapshots_shape: Shape of the snapshots.</span>
<span class="sd">    :type tuple: A tuple of ints containing the shape of a single snapshot.</span>
<span class="sd">    :param index_snap: the index of the snapshots to plot. By default, all</span>
<span class="sd">        the snapshots are plotted.</span>
<span class="sd">    :type index_snap: int or sequence(int)</span>
<span class="sd">    :param str filename: if specified, the plot is saved at `filename`.</span>
<span class="sd">    :param numpy.ndarray x: domain abscissa.</span>
<span class="sd">    :param numpy.ndarray y: domain ordinate</span>
<span class="sd">    :param order: read the elements of snapshots using this index order,</span>
<span class="sd">        and place the elements into the reshaped array using this index</span>
<span class="sd">        order.  It has to be the same used to store the snapshot. &#39;C&#39; means</span>
<span class="sd">        to read/ write the elements using C-like index order, with the last</span>
<span class="sd">        axis index changing fastest, back to the first axis index changing</span>
<span class="sd">        slowest.  &#39;F&#39; means to read / write the elements using Fortran-like</span>
<span class="sd">        index order, with the first index changing fastest, and the last</span>
<span class="sd">        index changing slowest.  Note that the &#39;C&#39; and &#39;F&#39; options take no</span>
<span class="sd">        account of the memory layout of the underlying array, and only</span>
<span class="sd">        refer to the order of indexing.  &#39;A&#39; means to read / write the</span>
<span class="sd">        elements in Fortran-like index order if a is Fortran contiguous in</span>
<span class="sd">        memory, C-like order otherwise.</span>
<span class="sd">    :type order: {&#39;C&#39;, &#39;F&#39;, &#39;A&#39;}, default &#39;C&#39;.</span>
<span class="sd">    :param tuple(int,int) figsize: tuple in inches defining the figure</span>
<span class="sd">        size. Default is (8, 8).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dmd</span><span class="o">.</span><span class="n">snapshots</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input snapshots not found.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">snapshots_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">snapshots_shape</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">snapshots_shape</span>

    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">snapshots_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;No information about the original shape of the snapshots.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The dimension of the snapshots is not 2D.&quot;</span><span class="p">)</span>

    <span class="c1"># If domain dimensions have not been passed as argument,</span>
    <span class="c1"># use the snapshots dimensions</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">xgrid</span><span class="p">,</span> <span class="n">ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">index_snap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">index_snap</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index_snap</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">index_snap</span> <span class="o">=</span> <span class="p">[</span><span class="n">index_snap</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">basename</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">index_snap</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Snapshot </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">snapshot</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>

        <span class="n">contour</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
            <span class="n">xgrid</span><span class="p">,</span>
            <span class="n">ygrid</span><span class="p">,</span>
            <span class="n">snapshot</span><span class="p">,</span>
            <span class="n">vmin</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="n">vmax</span><span class="o">=</span><span class="n">snapshot</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">basename</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">idx</span><span class="si">}{</span><span class="n">ext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="plot_summary"><a class="viewcode-back" href="../../plotter.html#pydmd.plotter.plot_summary">[docs]</a><span class="k">def</span><span class="w"> </span><span class="nf">plot_summary</span><span class="p">(</span>
    <span class="n">dmd</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">continuous</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">snapshots_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">index_modes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">order</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">tight_layout_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">main_colors</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;g&quot;</span><span class="p">),</span>
    <span class="n">mode_color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="n">mode_cmap</span><span class="o">=</span><span class="s2">&quot;bwr&quot;</span><span class="p">,</span>
    <span class="n">dynamics_color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
    <span class="n">rank_color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span>
    <span class="n">circle_color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">,</span>
    <span class="n">sval_ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">max_eig_ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">max_sval_plot</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">title_fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">label_fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">plot_semilogy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">flip_continuous_axes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a 3 x 3 summarizing plot that contains the following components:</span>
<span class="sd">    - the singular value spectrum of the data</span>
<span class="sd">    - the discrete-time and continuous-time DMD eigenvalues</span>
<span class="sd">    - the DMD modes specified by the `index_modes` parameter</span>
<span class="sd">    - the time dynamics that correspond with each plotted mode</span>
<span class="sd">    The number of singular values used for the DMD fit are highlighted.</span>
<span class="sd">    All eigenvalues, modes, and dynamics are sorted according to the magnitude</span>
<span class="sd">    of their corresponding amplitude value, i.e. their significance in the fit.</span>
<span class="sd">    Correspondence between eigenvalues, modes, and dynamics is indicated via</span>
<span class="sd">    color coordination.</span>

<span class="sd">    :param dmd: fitted DMD instance.</span>
<span class="sd">    :type dmd: pydmd.DMDBase</span>
<span class="sd">    :param x: Points along the 1st spatial dimension where data has been</span>
<span class="sd">        collected.</span>
<span class="sd">    :type x: np.ndarray or iterable</span>
<span class="sd">    :param y: Points along the 2nd spatial dimension where data has been</span>
<span class="sd">        collected. Note that this parameter is only applicable when the data</span>
<span class="sd">        snapshots are 2-D, which must be indicated with `snapshots_shape`.</span>
<span class="sd">    :type y: np.ndarray or iterable</span>
<span class="sd">    :param t: The times of data collection, or the time-step between snapshots.</span>
<span class="sd">        Note that time information must be accurate in order to accurately</span>
<span class="sd">        visualize eigenvalues and times of the dynamics. For non-`BOPDMD`</span>
<span class="sd">        models, the entries of t are assumed to be uniformly-spaced, and if</span>
<span class="sd">        not provided, TimeDict information is used. This parameter is ignored</span>
<span class="sd">        if an instance of `BOPDMD` is provided.</span>
<span class="sd">    :type t: {numpy.ndarray, iterable} or {int, float}</span>
<span class="sd">    :param d: Number of delays applied to the data passed to the DMD instance.</span>
<span class="sd">        If `d` is greater than 1, then each plotted mode will be the average</span>
<span class="sd">        mode taken across all `d` delays.</span>
<span class="sd">    :type d: int</span>
<span class="sd">    :param continuous: Whether or not the eigenvalues of the given DMD instance</span>
<span class="sd">        are continuous-time. If `False`, the eigenvalues are assumed to be the</span>
<span class="sd">        discrete-time eigenvalues. If `True`, the eigenvalues are taken to be</span>
<span class="sd">        the continuous-time eigenvalues. Note that `continuous` is</span>
<span class="sd">        automatically assumed to be `True` if a `BOPDMD` model is given.</span>
<span class="sd">    :type continuous: bool</span>
<span class="sd">    :param snapshots_shape: Shape of the snapshots. If not provided, the shape</span>
<span class="sd">        of the snapshots and modes is assumed to be the flattened space dim of</span>
<span class="sd">        the snapshot data. Provide as width, height dimension.</span>
<span class="sd">    :type snapshots_shape: iterable</span>
<span class="sd">    :param index_modes: Indices of the modes to plot after they have been</span>
<span class="sd">        sorted based on significance. At most three may be provided.</span>
<span class="sd">        By default, the first three leading modes are plotted.</span>
<span class="sd">    :type index_modes: iterable</span>
<span class="sd">    :param filename: If specified, the plot is saved at `filename`.</span>
<span class="sd">    :type filename: str</span>
<span class="sd">    :param order: Read the elements of snapshots using this index order,</span>
<span class="sd">        and place the elements into the reshaped array using this index order.</span>
<span class="sd">        It has to be the same used to store the snapshot. &quot;C&quot; means to</span>
<span class="sd">        read/write the elements using C-like index order, with the last axis</span>
<span class="sd">        index changing fastest, back to the first axis index changing slowest.</span>
<span class="sd">        &quot;F&quot; means to read/write the elements using Fortran-like index order,</span>
<span class="sd">        with the first index changing fastest, and the last index changing</span>
<span class="sd">        slowest. Note that the &quot;C&quot; and &quot;F&quot; options take no account of the</span>
<span class="sd">        memory layout of the underlying array, and only refer to the order of</span>
<span class="sd">        indexing. &quot;A&quot; means to read/write the elements in Fortran-like index</span>
<span class="sd">        order if a is Fortran contiguous in memory, C-like order otherwise.</span>
<span class="sd">        &quot;C&quot; is used by default.</span>
<span class="sd">    :type order: {&quot;C&quot;, &quot;F&quot;, &quot;A&quot;}</span>
<span class="sd">    :param figsize: Width, height in inches.</span>
<span class="sd">    :type figsize: iterable</span>
<span class="sd">    :param dpi: Figure resolution.</span>
<span class="sd">    :type dpi: int</span>
<span class="sd">    :param tight_layout_kwargs: Dictionary of `tight_layout` parameters.</span>
<span class="sd">    :type tight_layout_kwargs: dict</span>
<span class="sd">    :param main_colors: Colors used to denote eigenvalue, mode, dynamics</span>
<span class="sd">        associations.</span>
<span class="sd">    :type main_colors: iterable</span>
<span class="sd">    :param mode_color: Color used to plot the modes, if modes are 1-D.</span>
<span class="sd">    :type mode_color: str</span>
<span class="sd">    :param mode_cmap: Colormap used to plot the modes, if modes are 2-D.</span>
<span class="sd">    :type mode_cmap: str</span>
<span class="sd">    :param dynamics_color: Color used to plot the dynamics.</span>
<span class="sd">    :type dynamics_color: str</span>
<span class="sd">    :param rank_color: Color used to highlight the rank of the DMD fit and</span>
<span class="sd">        all DMD eigenvalues aside from those highlighted by `index_modes`.</span>
<span class="sd">    :type rank_color: str</span>
<span class="sd">    :param circle_color: Color used to plot the unit circle.</span>
<span class="sd">    :type circle_color: str</span>
<span class="sd">    :param sval_ms: Marker size of all singular values.</span>
<span class="sd">    :type sval_ms: int</span>
<span class="sd">    :param max_eig_ms: Marker size of the most prominent eigenvalue. The marker</span>
<span class="sd">        sizes of all other eigenvalues are then scaled according to eigenvalue</span>
<span class="sd">        significance.</span>
<span class="sd">    :type max_eig_ms: int</span>
<span class="sd">    :param max_sval_plot: Maximum number of singular values to plot. If the DMD</span>
<span class="sd">        instance was fitted via the `fit_econ` method, the maximum number of</span>
<span class="sd">        singular values that can be plotted is determined by the length of the</span>
<span class="sd">        array of singular values passed to `fit_econ`.</span>
<span class="sd">    :type max_sval_plot: int</span>
<span class="sd">    :param title_fontsize: Fontsize used for subplot titles.</span>
<span class="sd">    :type title_fontsize: int</span>
<span class="sd">    :param label_fontsize: Fontsize used for axis labels.</span>
<span class="sd">    :type label_fontsize: int</span>
<span class="sd">    :param plot_semilogy: Whether or not to plot the singular values on a</span>
<span class="sd">        semilogy plot. If `True`, a semilogy plot is used.</span>
<span class="sd">    :type plot_semilogy: bool</span>
<span class="sd">    :param flip_continuous_axes: Whether or not to swap the real and imaginary</span>
<span class="sd">        axes on the continuous eigenvalues plot. If `True`, the real axis will</span>
<span class="sd">        be vertical and the imaginary axis will be horizontal, and vice versa.</span>
<span class="sd">    :type flip_continuous_axes: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># This plotting method is inappropriate for plotting HAVOK results.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">HAVOK</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You should use HAVOK.plot_summary() instead.&quot;</span><span class="p">)</span>

    <span class="c1"># Check that the DMD instance has been fitted.</span>
    <span class="k">if</span> <span class="n">dmd</span><span class="o">.</span><span class="n">modes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You need to perform fit() first.&quot;</span><span class="p">)</span>

    <span class="c1"># By default, snapshots_shape is the flattened space dimension.</span>
    <span class="k">if</span> <span class="n">snapshots_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">snapshots_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span> <span class="o">//</span> <span class="n">d</span><span class="p">,)</span>
    <span class="c1"># If provided, snapshots_shape must contain 2 entires.</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;snapshots_shape must be None or 2-D.&quot;</span><span class="p">)</span>

    <span class="c1"># Check the length of index_modes.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index_modes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;index_modes must have a length of at most 3.&quot;</span><span class="p">)</span>

    <span class="c1"># Get the actual rank used for the DMD fit.</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="p">)</span>

    <span class="c1"># Ensure that at least rank-many singular values will be plotted.</span>
    <span class="k">if</span> <span class="n">rank</span> <span class="o">&gt;</span> <span class="n">max_sval_plot</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max_sval_plot must be at least </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Override index_modes if there are less than 3 modes available.</span>
    <span class="k">if</span> <span class="n">rank</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Provided DMD model has less than 3 modes.&quot;</span>
            <span class="s2">&quot;Plotting all available modes...&quot;</span>
        <span class="p">)</span>
        <span class="n">index_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>

    <span class="c1"># Indices cannot go past the total number of available modes.</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">index_modes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">rank</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot view past mode </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="c1"># Sort eigenvalues, modes, and dynamics according to amplitude magnitude.</span>
    <span class="n">mode_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">amplitudes</span><span class="p">))</span>
    <span class="n">lead_eigs</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">eigs</span><span class="p">[</span><span class="n">mode_order</span><span class="p">]</span>
    <span class="n">lead_modes</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">modes</span><span class="p">[:,</span> <span class="n">mode_order</span><span class="p">]</span>
    <span class="n">lead_dynamics</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">dynamics</span><span class="p">[</span><span class="n">mode_order</span><span class="p">]</span>
    <span class="n">lead_amplitudes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">amplitudes</span><span class="p">[</span><span class="n">mode_order</span><span class="p">])</span>

    <span class="c1"># Get time information for eigenvalue conversions.</span>
    <span class="c1"># The decisions that we make here depend on if we&#39;re dealing</span>
    <span class="c1"># with a BOPDMD model or any other type of DMD model...</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">BOPDMD</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">PrePostProcessingDMD</span><span class="p">)</span>
        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">pre_post_processed_dmd</span><span class="p">,</span> <span class="n">BOPDMD</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="c1"># BOPDMD models store time in the time attribute.</span>
        <span class="c1"># BOPDMD models also always compute continuous-time eigenvalues.</span>
        <span class="n">cont_eigs</span> <span class="o">=</span> <span class="n">lead_eigs</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">time</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">dmd</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dmd</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">dmd</span><span class="o">.</span><span class="n">time</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dt</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Time step is not uniform. &quot;</span>
                <span class="s2">&quot;No discrete-time eigenvalues to plot...&quot;</span>
            <span class="p">)</span>
            <span class="n">disc_eigs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">disc_eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lead_eigs</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># For all other dmd models, go to the TimeDict for time information,</span>
        <span class="c1"># that or use the user-provided time information in t if available.</span>
        <span class="n">num_samples</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">t</span>
        <span class="k">elif</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">time</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dt</span><span class="p">):</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Time step is not uniform. DMD might produce unexpected &quot;</span>
                    <span class="s2">&quot;results. Consider using BOP-DMD instead.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">time</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">original_timesteps</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">original_time</span><span class="p">[</span><span class="s2">&quot;dt&quot;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;No time information available. Using dt = 1 and t0 = 0.&quot;</span>
                <span class="p">)</span>
                <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">if</span> <span class="n">continuous</span><span class="p">:</span>
            <span class="n">cont_eigs</span> <span class="o">=</span> <span class="n">lead_eigs</span>
            <span class="n">disc_eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">lead_eigs</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">disc_eigs</span> <span class="o">=</span> <span class="n">lead_eigs</span>
            <span class="n">cont_eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">lead_eigs</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span>

    <span class="c1"># Get mode averages across delays if time-delay was used.</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">lead_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span>
            <span class="n">lead_modes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
                <span class="n">d</span><span class="p">,</span>
                <span class="n">lead_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="n">d</span><span class="p">,</span>
                <span class="n">lead_modes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Compute the singular values of the data matrix.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dmd</span><span class="p">,</span> <span class="n">HankelDMD</span><span class="p">):</span>
        <span class="c1"># Use time-delay data matrix to compute singular values.</span>
        <span class="n">snp</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">ho_snapshots</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Use input data matrix to compute singular values.</span>
        <span class="n">snp</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">snapshots</span>
    <span class="k">if</span> <span class="n">snp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">snp</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">dmd</span><span class="o">.</span><span class="n">_singular_values</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Snapshots and singular values are not available.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="c1"># Compute the percent of data variance captured by each singular value.</span>
    <span class="n">s_var</span> <span class="o">=</span> <span class="n">s</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">s_var</span> <span class="o">=</span> <span class="n">s_var</span><span class="p">[:</span><span class="n">max_sval_plot</span><span class="p">]</span>

    <span class="c1"># Build a list of indices of the complex conjugate pairs to highlight.</span>
    <span class="c1"># Example: If index_modes = [idx1, idx2, idx3, idx4], such that...</span>
    <span class="c1">#   idx1 has no complex conjugate pair</span>
    <span class="c1">#   idx2 and idx3 are complex conjugates</span>
    <span class="c1">#   idx4 and idx5 are complex conjugates</span>
    <span class="c1"># Then index_modes_cc = [(idx1, idx1), (idx2, idx3), (idx4, idx5)]</span>
    <span class="n">index_modes_cc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">index_modes</span><span class="p">:</span>
        <span class="n">eig</span> <span class="o">=</span> <span class="n">cont_eigs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">eig</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cont_eigs</span><span class="p">:</span>
            <span class="n">index_modes_cc</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">idx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">index_modes_cc</span><span class="p">):</span>
            <span class="n">index_modes_cc</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">idx</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cont_eigs</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">eig</span><span class="o">.</span><span class="n">conj</span><span class="p">())))</span>
    <span class="n">other_eigs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">setdiff1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">rank</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">index_modes_cc</span><span class="p">))</span>

    <span class="c1"># Generate the summarizing plot.</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">eig_axes</span><span class="p">,</span> <span class="n">mode_axes</span><span class="p">,</span> <span class="n">dynamics_axes</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="mi">3</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># PLOT 1: Plot the singular value spectrum.</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Singular Values&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;% variance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>
    <span class="n">s_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s_var</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">s_t</span><span class="p">[:</span><span class="n">rank</span><span class="p">],</span>
        <span class="n">s_var</span><span class="p">[:</span><span class="n">rank</span><span class="p">],</span>
        <span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="n">rank_color</span><span class="p">,</span>
        <span class="n">ms</span><span class="o">=</span><span class="n">sval_ms</span><span class="p">,</span>
        <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">s_t</span><span class="p">[</span><span class="n">rank</span><span class="p">:],</span>
        <span class="n">s_var</span><span class="p">[</span><span class="n">rank</span><span class="p">:],</span>
        <span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
        <span class="n">ms</span><span class="o">=</span><span class="n">sval_ms</span><span class="p">,</span>
        <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
        <span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">rank_color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rank of fit&quot;</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_semilogy</span><span class="p">:</span>
        <span class="n">eig_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">()</span>

    <span class="c1"># PLOTS 2-3: Plot the eigenvalues (discrete-time and continuous-time).</span>
    <span class="c1"># Scale marker sizes to reflect their associated amplitude.</span>
    <span class="n">ms_vals</span> <span class="o">=</span> <span class="n">max_eig_ms</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">lead_amplitudes</span> <span class="o">/</span> <span class="n">lead_amplitudes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># PLOT 2: Plot the discrete-time eigenvalues on the unit circle.</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Discrete-time Eigenvalues&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">circle_color</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Re(\lambda)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Im(\lambda)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>

    <span class="c1"># PLOT 3: Plot the continuous-time eigenvalues.</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
        <span class="s2">&quot;Continuous-time Eigenvalues&quot;</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">flip_continuous_axes</span><span class="p">:</span>
        <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Im(\omega)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>
        <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Re(\omega)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>
        <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
        <span class="n">cont_eigs</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">cont_eigs</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="n">cont_eigs</span><span class="o">.</span><span class="n">imag</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Re(\omega)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>
        <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Im(\omega)$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>

    <span class="c1"># Now plot the eigenvalues and record the colors used for each main index.</span>
    <span class="n">mode_colors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">eigs</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">eig_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">eig_axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[</span><span class="n">disc_eigs</span><span class="p">,</span> <span class="n">cont_eigs</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">eigs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Plot the main indices and their complex conjugate.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">indices</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">index_modes_cc</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                        <span class="n">eigs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                        <span class="n">eigs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                        <span class="s2">&quot;o&quot;</span><span class="p">,</span>
                        <span class="n">c</span><span class="o">=</span><span class="n">main_colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                        <span class="n">ms</span><span class="o">=</span><span class="n">ms_vals</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
                        <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">mode_colors</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># Plot all other DMD eigenvalues.</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">other_eigs</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                    <span class="n">eigs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                    <span class="n">eigs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span>
                    <span class="s2">&quot;o&quot;</span><span class="p">,</span>
                    <span class="n">c</span><span class="o">=</span><span class="n">rank_color</span><span class="p">,</span>
                    <span class="n">ms</span><span class="o">=</span><span class="n">ms_vals</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
                    <span class="n">mec</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="c1"># Build the spatial grid for the mode plots.</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">xgrid</span><span class="p">,</span> <span class="n">ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># PLOTS 4-6: Plot the DMD modes.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mode_axes</span><span class="p">,</span> <span class="n">index_modes</span><span class="p">)):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Mode </span><span class="si">{</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="n">mode_colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">snapshots_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Plot modes in 1-D.</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lead_modes</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">mode_color</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Plot modes in 2-D.</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">lead_modes</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">real</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span>
                <span class="n">xgrid</span><span class="p">,</span>
                <span class="n">ygrid</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">.</span><span class="n">real</span><span class="p">,</span>
                <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                <span class="n">vmin</span><span class="o">=-</span><span class="n">vmax</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">mode_cmap</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Align the colorbar with the plotted image.</span>
            <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;3%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">)</span>

    <span class="c1"># PLOTS 7-9: Plot the DMD mode dynamics.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dynamics_axes</span><span class="p">,</span> <span class="n">index_modes</span><span class="p">)):</span>
        <span class="n">dynamics_data</span> <span class="o">=</span> <span class="n">lead_dynamics</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="s2">&quot;Mode Dynamics&quot;</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="n">mode_colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="n">title_fontsize</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">dynamics_data</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">dynamics_color</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">label_fontsize</span><span class="p">)</span>

        <span class="c1"># Re-adjust ylim if dynamics oscillations are extremely small.</span>
        <span class="n">dynamics_range</span> <span class="o">=</span> <span class="n">dynamics_data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">dynamics_data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dynamics_range</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">dynamics_data</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-4</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">dynamics_data</span><span class="p">)]))</span>

    <span class="c1"># Padding between elements.</span>
    <span class="k">if</span> <span class="n">tight_layout_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tight_layout_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="o">**</span><span class="n">tight_layout_kwargs</span><span class="p">)</span>

    <span class="c1"># Save plot if filename is provided.</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2025, PyDMD Contributors.
      <span class="lastupdated">Last updated on Apr 01, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>